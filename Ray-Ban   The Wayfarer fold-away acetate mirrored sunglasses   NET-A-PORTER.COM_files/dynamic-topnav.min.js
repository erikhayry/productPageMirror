var dynamicTopNav=function(){function F(){var a="-"+$(c+".main-menu .dd-wrapper").height()+"px";n=!0;r(c,"whatsNewStatus",{list:!0});$(c+".main-menu .dd-wrapper").wrap('<div class="top-nav-demo-wrapper"></div>');$(c+".main-menu .dd-wrapper").css("position","absolute");$(c+".main-menu .dd-wrapper").css("top",a);$(c+".main-menu .dd-menu").css("visibility","visible");$(c+".main-menu .dd-wrapper").animate({top:"0px"},1E3);s=setTimeout(function(){$(c+".main-menu").children("div").append("<div class='dd_arrow'></div>")}, 100)}function G(){var a="-"+$(c+".main-menu .dd-wrapper").height()+"px";t=setTimeout(function(){$(c+".main-menu .dd-wrapper").animate({top:a},1E3)},2500);u=setTimeout(function(){$(".dd_arrow").remove()},3400);v=setTimeout(function(){p()},3600)}function p(){!0===n&&($(c+".main-menu .dd-wrapper").stop(),clearTimeout(s),clearTimeout(u),clearTimeout(v),clearTimeout(t),$(c+".main-menu .dd-wrapper").css("top","0px"),$(c+".main-menu .dd-menu").css("visibility","hidden"),1<$(c+".main-menu .dd_arrow").length&& $(c+".main-menu .dd_arrow")[0].remove(),n=!1)}function w(a,b,d){$(a+".main-menu").on("hover touchstart",function(){p();r(a,b,d)})}function r(a,b,d){window.dynamicTopNav.exposeVariables[b]||(window.dynamicTopNav.exposeVariables[b]=!0,H(function(a){for(var b=q(),c=1,g,e,k,h=0;h<l;h++)if(g=103,e=127,d.cover&&(0===h&&(g=212,e=263),k="/magazine/"+a[h].number+"?topnav-_-edit-_-cover"+a[h].number,coverDiv='<a href="'+k+'" class="edit-cover"><img src="'+a[h].cover+'" width="'+g+'" height="'+e+'" alt="'+a[h].date.js+ '"></a>',$("."+b.editPromo+"-"+c).prepend(coverDiv),c+=1),d.list){k="/magazine/"+a[0].number+"?topnav-_-edit-_-cover"+a[0].number;g=a[0].shop;e=a[0].copy;var m=b.thEditDropDownListSelector;$("."+b.thEditDropDownListSelector).html('<li class="'+m+'"><a href="'+g+'">'+e+"</a></li>");g=a[0].current;$("."+b.editPromoMessageCurrent).html('<a href="'+k+'">'+g+"</a>");k=a[0].previous;g=I;$("."+b.editPromoMessagePrevious).html('<a href="'+g+'">'+k+"</a>")}}),".whatsNew"==a?J():x(".magazine",".porter-promo"))} function e(a,b,d){$(a+".main-menu").on("hover touchstart",function(){p();window.dynamicTopNav.exposeVariables[b]||(window.dynamicTopNav.exposeVariables[b]=!0,x(this,d))})}function x(a,b){var d=$(b,a);if(0<d.length){var d=$("img",d),f=d.data("src");d.attr("src",f)}}function H(a){m?a(m):(y(),K(function(b){b&&(b&&(m=b),a(b))}))}function J(){var a=q();L(function(b){if(0<b.length){var d="";$.each(b,function(){d+='<div class="product-feature-product"><a href="/product/'+this.pid+"?cm_sp=topnav-_-whats-new-_-"+ this.pid+'"><img class="product-feature-image" src="//cache.net-a-porter.com/images/products/'+this.pid+"/"+this.pid+'_in_sl.jpg" alt="'+this.desc+'" onmouseover="rollOverImage(this, \'//cache.net-a-porter.com/images/products/'+this.pid+"/"+this.pid+"_ou_sl.jpg', event)\" onmouseout=\"rollOverImage(this, '//cache.net-a-porter.com/images/products/"+this.pid+"/"+this.pid+'_in_sl.jpg\', event)"></a><div class="product-feature-details"><div class="product-feature-designer">'+this.designer+'</div><div class="product-feature-description">'+ this.desc+'</div><p class="product-feature-price">'+this.price+"</p></div></div>"});$("."+a.productPromoSelector).css("background-image","none");$("."+a.productPromoSelector).html(d)}else $("."+a.whatsNewProductPromo).remove()})}function y(){var a="Loading...";try{NAP.i18n.message("wishlist.mobile.loading")&&(a=NAP.i18n.message("wishlist.mobile.loading"))}catch(b){}return{loading:a}}function z(a,b,d,f){$(a).after('<li class="'+f+'"><a href="'+b+'">'+d+"</a></li>")}function L(a){$.ajax({url:A,dataType:"xml", success:function(b){var d=[],f={},c=0;$(b).find("product").each(function(){var a=$(this);c<M&&(f={pid:a.attr("id"),desc:a.attr("title"),designer:a.attr("manufacturer"),price:a.attr("currentPrice")},c++,d.push(f))});a(d)}})}function K(a){$.ajax({url:B,dataType:"json",success:function(b){for(var d=[],f=0;f<l;f++){var c=b.slice[f];d.push({current:b.bundle.magazine.archive.heading.value,previous:b.bundle.magazine.archive.extended.value,copy:b.bundle.magazine.shopTheMagazine.topNav.value,cover:c.cover, number:c.number,date:c.date,shop:c.shop})}a(d)}})}function N(a){for(var b={},d=0;d<a.length;d++)$("body").data(a[d])&&(b[a[d]]=$("body").data(a[d]));b&&(C=b)}function O(a){return a=(a?a:"/Shop/Whats-New")+P+D}function q(){return{quickLinksSelector:" .list-column.quick-links",quickLinksSelectorSecondChild:" .list-column.quick-links ul li:eq(0)",quickLinksSelectorThirdChild:" .list-column.quick-links ul li:eq(2)",whatsNewDropDownSelector:".whatsNew .list-column.quick-links ul li:eq(2)",mainMenuSelector:".magazine.main-menu", theEditDropDownQuickLinkSelector:".magazine.main-menu .list-column.quick-links ul li:eq(0)",thEditDropDownListSelector:"editCustomList",contentColumn:" .content-column",editPromo:"edit-promo",editPromoArchive:"edit-promo-archive",editPromoMessageCurrent:"edit-promo-message-current",editPromoMessagePrevious:"edit-promo-message-previous",columnSelector:" .content-column:eq(1)",whatsNewProductPromo:".whatsNew .content-column:eq(1)",productPromoSelector:"product-promo"}}function Q(a){a&&(B=a)}function R(a){a&& (A=a)}var S=["region","language","country"],P="?view=xml",D="&exclude=true",l=5,T="/magazineArchive.nap?limit="+l+"&getBundle=true&total="+l,I="/content/archive/extended?cm_sp=topnav-_-edit-_-previousissues",M=5,E=!1,c=".whatsNew",C,A,B,m=!1,n=!1,s,u,v,t;return{init:function(a,b){b&&(E=b);N(S);R(O(a));Q("/"+C.region+T+D);$(document).ready(function(){var a=y().loading,b=q();z(b.whatsNewDropDownSelector,"#",a,b.thEditDropDownListSelector);z(b.theEditDropDownQuickLinkSelector,"#",a,b.thEditDropDownListSelector); $('<div class="'+b.editPromo+" "+b.editPromo+'-1"></div>').insertAfter(b.mainMenuSelector+b.quickLinksSelector);$('<div class="'+b.editPromoArchive+'"></div>').insertAfter("."+b.editPromo+"-1");for(var a=l,c=1;c<l;c++)$("."+b.editPromoArchive).prepend('<div class="'+b.editPromo+" "+b.editPromo+"-"+a+'"></div>'),a-=1;$(b.whatsNewProductPromo).append('<div class="'+b.productPromoSelector+'"></div>');$("."+b.editPromo+"-1").append('<div class="'+b.editPromoMessageCurrent+'"></div>');$("."+b.editPromoArchive).append('<div class="'+ b.editPromoMessagePrevious+'"></div>');E?""===CookieUtil.getCookie("topNavDemo")&&(F(),G(),CookieUtil.setCookie("topNavDemo",!0,14)):""!==CookieUtil.getCookie("topNavDemo")&&CookieUtil.deleteCookie("topNavDemo");e(".sale");w(".whatsNew","whatsNewStatus",{list:!0});e(".designers","designerStatus",".marketing-promo");e(".clothing","clothingStatus",".marketing-promo");e(".bags","bagsStatus",".marketing-promo");e(".shoes","shoesStatus",".marketing-promo");e(".accessories","accessoriesStatus",".marketing-promo"); e(".lingerie","lingerieStatus",".marketing-promo");e(".beauty","beautyStatus",".marketing-promo");w(".magazine","editStatus",{list:!0,cover:!0})})},exposeVariables:function(){return{archiveObj:m,whatsNewStatus:!1,designerStatus:!1,clothingStatus:!1,bagsStatus:!1,shoesStatus:!1,accessotiesStatus:accessotiesStatus,lingerieStatus:!1,beauty:beauty,editStatus:!1}}}}();